<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Navigation API &#8212; pylanetary  documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=4f649999" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css?v=039e1c02" />
    <script src="_static/documentation_options.js?v=5929fcd5"></script>
    <script src="_static/doctools.js?v=888ff710"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Rings API" href="rings_api.html" />
    <link rel="prev" title="Citing this Software" href="citing.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="module-pylanetary.navigation.core">
<span id="navigation-api"></span><h1>Navigation API<a class="headerlink" href="#module-pylanetary.navigation.core" title="Link to this heading">¶</a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="pylanetary.navigation.core.ModelBody">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pylanetary.navigation.core.</span></span><span class="sig-name descname"><span class="pre">ModelBody</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">body</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pixscale</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pylanetary.navigation.core.ModelBody" title="Link to this definition">¶</a></dt>
<dd><p>Wrapper to ModelEllipsoid that permits passing an ephemeris</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pylanetary.navigation.core.ModelEllipsoid">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pylanetary.navigation.core.</span></span><span class="sig-name descname"><span class="pre">ModelEllipsoid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ob_lon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ob_lat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pixscale_km</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">np_ang</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">req</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rpol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0.0,</span> <span class="pre">0.0)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sun_lon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sun_lat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">longitude_convention</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'w'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pylanetary.navigation.core.ModelEllipsoid" title="Link to this definition">¶</a></dt>
<dd><p>Projection of an ellipsoid onto a 2-D array with latitude and longitude grid</p>
<dl class="py method">
<dt class="sig sig-object py" id="pylanetary.navigation.core.ModelEllipsoid.ldmodel">
<span class="sig-name descname"><span class="pre">ldmodel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beam</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">law</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'exp'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">psf_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gaussian'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pylanetary.navigation.core.ModelEllipsoid.ldmodel" title="Link to this definition">¶</a></dt>
<dd><p>Make a limb-darkened model disk convolved with the beam
See docstring of limb_darkening() for options</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tb</strong> (<em>float</em><em>, </em><em>required.</em>) – [flux] brightness temperature of disk at mu=1</p></li>
<li><p><strong>a</strong> (<em>float</em><em> or </em><em>tuple</em><em>, </em><em>required.</em>) – [-] limb darkening parameter(s)</p></li>
<li><p><strong>beam</strong> (<em>float</em><em> or </em><em>tuple</em><em> or </em><em>np.array</em>) – units pixels. see docstring of utils.convolve_with_beam</p></li>
<li><p><strong>law</strong> (<em>str</em><em>, </em><em>optional</em><em>, </em><em>default &quot;exp&quot;</em>) – limb darkening law</p></li>
<li><p><strong>mu0</strong> (<em>np.array</em><em>, </em><em>optional</em><em>, </em><em>default None</em>) – cosine of solar incidence angle.
if None, code will check if self.mu0 is defined, and use that
has no effect unless law==”minnaert”.
if self.mu0 undefined, law==”minnaert”, and mu0=None, then
code will fail</p></li>
<li><p><strong>psf_mode</strong> (<em>str</em><em>, </em><em>optional</em><em>, </em><em>default &quot;gaussian&quot;</em>) – mode to use for convolve_with_beam(), options “airy”, “gaussian”</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pylanetary.navigation.core.ModelEllipsoid.zonalmodel">
<span class="sig-name descname"><span class="pre">zonalmodel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lons</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tbs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pylanetary.navigation.core.ModelEllipsoid.zonalmodel" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pylanetary.navigation.core.Nav">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pylanetary.navigation.core.</span></span><span class="sig-name descname"><span class="pre">Nav</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">body</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pixscale</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pylanetary.navigation.core.Nav" title="Link to this definition">¶</a></dt>
<dd><p>functions for comparing a model ellipsoid with observed 2-d imaging data</p>
<dl class="py method">
<dt class="sig sig-object py" id="pylanetary.navigation.core.Nav.colocate">
<span class="sig-name descname"><span class="pre">colocate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'convolution'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diagnostic_plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pylanetary.navigation.core.Nav.colocate" title="Link to this definition">¶</a></dt>
<dd><p>Co-locate the model planet with the observed planet</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mode</strong> (<em>str</em><em>, </em><em>optional. Default 'convolution'.</em>) – <p>Which method should be used to overlay planet model and data. Choices are:</p>
<ul>
<li><dl class="simple">
<dt>’canny’: uses the Canny edge detection algorithm.</dt><dd><dl class="simple">
<dt>kwargs:</dt><dd><dl class="field-list simple">
<dt class="field-odd">tb<span class="colon">:</span></dt>
<dd class="field-odd"><p>float, required.
[same flux unit as data] brightness temperature of disk at mu=1</p>
</dd>
<dt class="field-even">a<span class="colon">:</span></dt>
<dd class="field-even"><p>float, required.
[-] exponential limb darkening param</p>
</dd>
<dt class="field-odd">law<span class="colon">:</span></dt>
<dd class="field-odd"><p>str, optional. default ‘exp’
type of limb darkening model to use</p>
</dd>
<dt class="field-even">beam<span class="colon">:</span></dt>
<dd class="field-even"><p>float, tuple, or np.array, optional. default None.
units pixels. see utils.convolve_with_beam</p>
</dd>
<dt class="field-odd">psf_mode<span class="colon">:</span></dt>
<dd class="field-odd"><p>str, optional. default “gaussian”
what beam shape to use, options “airy”, “gaussian”</p>
</dd>
<dt class="field-even">low_thresh<span class="colon">:</span></dt>
<dd class="field-even"><p>float, required.
see documentation of skimage.feature.canny</p>
</dd>
<dt class="field-odd">high_thresh<span class="colon">:</span></dt>
<dd class="field-odd"><p>float, required.
see documentation of skimage.feature.canny</p>
</dd>
<dt class="field-even">sigma<span class="colon">:</span></dt>
<dd class="field-even"><p>int, required.
see documentation of skimage.feature.canny</p>
</dd>
</dl>
</dd>
<dt>To find edges of planet disk, typical “good” values are:</dt><dd><p>low_thresh : RMS noise in image
high_thresh : approximate flux value of background disk (i.e., cloud-free, volcano-free region)
sigma : 5</p>
</dd>
</dl>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>’convolution’: takes the shift that maximizes the convolution of model and planet</dt><dd><dl class="simple">
<dt>kwargs:</dt><dd><dl class="field-list simple">
<dt class="field-odd">tb<span class="colon">:</span></dt>
<dd class="field-odd"><p>float, required.
[same flux unit as data] brightness temperature of disk at mu=1</p>
</dd>
<dt class="field-even">a<span class="colon">:</span></dt>
<dd class="field-even"><p>float, required.
[-] limb darkening parameter</p>
</dd>
<dt class="field-odd">law<span class="colon">:</span></dt>
<dd class="field-odd"><p>str, optional. default ‘exp’
type of limb darkening model to use</p>
</dd>
<dt class="field-even">beam<span class="colon">:</span></dt>
<dd class="field-even"><p>float, tuple, or np.array, optional. default None.
units pixels. see utils.convolve_with_beam</p>
</dd>
<dt class="field-odd">psf_mode<span class="colon">:</span></dt>
<dd class="field-odd"><p>str, optional. default “gaussian”
what beam shape to use, options “airy”, “gaussian”</p>
</dd>
<dt class="field-even">err<span class="colon">:</span></dt>
<dd class="field-even"><p>float
per-pixel error in input image</p>
</dd>
</dl>
</dd>
</dl>
</dd>
</dl>
</li>
<li><p>’disk’: same as convolution</p></li>
</ul>
</p></li>
<li><p><strong>diagnostic_plot</strong> (<em>bool</em><em>, </em><em>optional. default True</em>) – do you want the diagnostic plots to be shown</p></li>
<li><p><strong>save_plot</strong> (<em>str</em><em>, </em><em>optional. default None.</em>) – file path to save the diagnostic plot. if None, does not save.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>float</em> – dx in pixels. best-fit difference in position between model and data
To shift data to center (i.e., colocated with model), apply a shift of -dx, -dy
To shift model to data, apply a shift of dx, dy</p></li>
<li><p><em>float</em> – dy in pixels</p></li>
<li><p><em>float</em> – dxerr in pixels uncertainty in the shift based on the cross-correlation
from image_registration.chi2_shift. These should be treated with extreme caution
because they were designed to work on identical images corrupted by random
noise, and are being used for non-identical images (model and data)</p></li>
<li><p><em>float</em> – dyerr in pixels</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>need at least one example of each mode here</p>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>sometimes dxerr, dyerr give unrealistic or undefined behavior</p></li>
</ul>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pylanetary.navigation.core.Nav.reproject">
<span class="sig-name descname"><span class="pre">reproject</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">projection</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'equirectangular'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pylanetary.navigation.core.Nav.reproject" title="Link to this definition">¶</a></dt>
<dd><p>Projects the navigated data into the target projection
This function only works properly if self.lat_g and self.lon_w
are centered with respect to self.data; for instance,
if ONE of xy_shift_data or xy_shift_model has been applied
using the dx, dy output of colocate()</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>projection</strong> (<em>str</em><em> or </em><em>cartopy.proj.Projection instance</em><em>, </em><em>optional. default 'equirectangular'</em>) – string options are [‘equirectangular’, ‘polar’]
any cartopy Projection object is also accepted, but in this case shape must be specified
see <a class="reference external" href="https://scitools.org.uk/cartopy/docs/v0.15/crs/projections.html">cartopy projection list</a>.</p></li>
<li><p><strong>shape</strong> (<em>tuple</em><em>, </em><em>optional. default None</em>) – shape of output arrays.
if None, shape is guessed from pixel scale of input image</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>np.array</em> – the projected data</p></li>
<li><p><em>np.array</em> – cosine of the emission angle (mu)
at each pixel in the projection</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pylanetary.navigation.core.Nav.write">
<span class="sig-name descname"><span class="pre">write</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">outstem</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">header</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flux_unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pylanetary.navigation.core.Nav.write" title="Link to this definition">¶</a></dt>
<dd><p>Writes navigated data to multi-extension fits</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>outstem</strong> (<em>str</em><em>, </em><em>required.</em>) – stem of filenames to write</p></li>
<li><p><strong>header</strong> (<em>dict</em><em>, </em><em>optional</em><em>, </em><em>default {}</em>) – dictionary of header info to put into hdul[0].header</p></li>
<li><p><strong>flux_unit</strong> (<em>str</em><em>, </em><em>optional</em><em>, </em><em>default &quot;&quot;</em>) – unit of flux to put in output fits header</p></li>
<li><p><strong>Writes</strong> – </p></li>
<li><p><strong>------</strong> – </p></li>
<li><p><strong>file</strong> (<em>fits</em>) – </p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>hdul[0] contains the header, data is empty
hdul[1] contains the data
hdul[2] contains latitudes
hdul[3] contains longitudes
hdul[4] contains emission angles
hdul[5] contains solar incidence angles</p>
<p class="rubric">References</p>
<p>NAV multi-extension fits file format originally pioneered by Mike Wong
e.g. <a class="reference external" href="https://doi.org/10.3847/1538-4365/ab775f">https://doi.org/10.3847/1538-4365/ab775f</a></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pylanetary.navigation.core.Nav.xy_shift_data">
<span class="sig-name descname"><span class="pre">xy_shift_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dy</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pylanetary.navigation.core.Nav.xy_shift_data" title="Link to this definition">¶</a></dt>
<dd><p>FFTshift data by a user-defined amount
for example, to apply the suggested shift from colocate()
it is preferred to use xy_shift_model() instead, which avoids
touching the data</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dx</strong> (<em>float</em><em>, </em><em>required</em>) – [pixels] shift in x</p></li>
<li><p><strong>dy</strong> (<em>float</em><em>, </em><em>required</em>) – [pixels] shift in y</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pylanetary.navigation.core.Nav.xy_shift_model">
<span class="sig-name descname"><span class="pre">xy_shift_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dy</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pylanetary.navigation.core.Nav.xy_shift_model" title="Link to this definition">¶</a></dt>
<dd><p>shift model (i.e., lat_g, lon_w, mu, and mu0)
by recalculating the model with a different center
as defined by user-defined dx, dy shift</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dx</strong> (<em>float</em><em>, </em><em>required</em>) – [pixels] shift in x</p></li>
<li><p><strong>dy</strong> (<em>float</em><em>, </em><em>required</em>) – [pixels] shift in y</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pylanetary.navigation.core.colocate_diagnostic_plot">
<span class="sig-prename descclassname"><span class="pre">pylanetary.navigation.core.</span></span><span class="sig-name descname"><span class="pre">colocate_diagnostic_plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pylanetary.navigation.core.colocate_diagnostic_plot" title="Link to this definition">¶</a></dt>
<dd><p>assesses goodness-of-fit of navigation solution from colocate</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>np.array</em><em>, </em><em>required</em>) – shifted model data</p></li>
<li><p><strong>data</strong> (<em>np.array</em><em>, </em><em>required</em>) – observed data</p></li>
<li><p><strong>mode</strong> (<em>str</em><em>, </em><em>required</em>) – method of co-location, one of [“canny”, “convolution”, or “disk”]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>matplotlib figure and axis objects</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>fig, ax</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pylanetary.navigation.core.emission_angle">
<span class="sig-prename descclassname"><span class="pre">pylanetary.navigation.core.</span></span><span class="sig-name descname"><span class="pre">emission_angle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ob_lat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">surf_n</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pylanetary.navigation.core.emission_angle" title="Link to this definition">¶</a></dt>
<dd><p>Computes the cosine of the emission angle of surface wrt observer</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ob_lat</strong> (<em>float</em><em> or </em><em>np.array</em><em>, </em><em>required.</em>) – [deg] sub-observer latitude</p></li>
<li><p><strong>surf_n</strong> (<em>np.array</em><em>, </em><em>required.</em>) – [x,y,z] surface normal vector at each ob_lat</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>cosine of emission angle</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float or np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pylanetary.navigation.core.lat_lon">
<span class="sig-prename descclassname"><span class="pre">pylanetary.navigation.core.</span></span><span class="sig-name descname"><span class="pre">lat_lon</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pixscale_km</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ob_lon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ob_lat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">np_ang</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_e</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">longitude_convention</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'w'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pylanetary.navigation.core.lat_lon" title="Link to this definition">¶</a></dt>
<dd><p>Computes the planetographic and planetocentric latitudes and west longitudes
of an ellipsoidal planet as viewed from a tilted perspective, i.e., on the sky
For now, this relies on manually de-rotating the planet and using Cartopy’s
orthographic projection, because pyproj TiltedPerspective cannot handle
ellipsoidal planets, only spheres.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>shape</strong> (<em>tuple</em><em>, </em><em>required</em>) – shape of output arrays</p></li>
<li><p><strong>pixscale_km</strong> (<em>float</em><em>, </em><em>required</em>) – [km/px] pixel scale of image</p></li>
<li><p><strong>ob_lon</strong> (<em>float</em><em>, </em><em>required</em>) – [deg] sub-observer planetographic longitude</p></li>
<li><p><strong>ob_lat</strong> (<em>float</em><em>, </em><em>required</em>) – [deg] sub-observer planetographic latitude</p></li>
<li><p><strong>np_ang</strong> (<em>float</em><em>, </em><em>required</em>) – [deg] north polar angle</p></li>
<li><p><strong>r_e</strong> (<em>float</em><em>, </em><em>required</em>) – [km] equatorial radius of planet</p></li>
<li><p><strong>r_p</strong> (<em>float</em><em>, </em><em>required</em>) – [km] polar radius of planet</p></li>
<li><p><strong>dx</strong> (<em>float</em><em>, </em><em>optional</em><em>, </em><em>default 0</em>) – [px] offset in x from the center of the image</p></li>
<li><p><strong>dy</strong> (<em>float</em><em>, </em><em>optional</em><em>, </em><em>default 0</em>) – [px] offset in y from the center of the image</p></li>
<li><p><strong>longitude_convention</strong> (<em>str</em><em>, </em><em>optional</em><em>, </em><em>default 'w'</em>) – east or west longitude convention</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>np.array</em> – planetographic latitudes</p></li>
<li><p><em>np.array</em> – planetocentric latitudes</p></li>
<li><p><em>np.array</em> – West longitudes</p></li>
<li><p><em>np.array</em> – x-coordinates of image grid in km, where 0 is center of planet</p></li>
<li><p><em>np.array</em> – y-coordinates of image grid in km, where 0 is center of planet</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pylanetary.navigation.core.limb_darkening">
<span class="sig-prename descclassname"><span class="pre">pylanetary.navigation.core.</span></span><span class="sig-name descname"><span class="pre">limb_darkening</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">law</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'exp'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pylanetary.navigation.core.limb_darkening" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mu</strong> (<em>float</em><em> or </em><em>array-like</em><em>, </em><em>required.</em>) – [-] cosine of emission angle</p></li>
<li><p><strong>a</strong> (<em>float</em><em> or </em><em>array-like</em><em>, </em><em>required.</em>) – [-] limb-darkening parameter(s)
if law==”disc”, a is ignored
if law==”exp”, “linear”, or “minnaert”, a must have length 1
if law==”quadratic”, “square-root”, a must have length 2 such that [a0, a1] are
the free parameters in the first and second terms, respectively.</p></li>
<li><p><strong>law</strong> (<em>str</em><em>, </em><em>optional. default &quot;exp&quot;.</em>) – what type of limb darkening law to use. options are:
disc : no limb darkening applied
linear : ld = 1 - a * (1 - mu)
exp : ld = mu**a
minnaert : ld = mu0**a * mu**(a-1)
quadratic : ld = 1 - a[0]*(1-mu) - a[1]*(1-mu)**2
square-root : ld = 1 - a[0]*(1-mu) - a[1]*(1-np.sqrt(mu))</p></li>
<li><p><strong>mu0</strong> (<em>float</em><em> or </em><em>array-like</em><em>, </em><em>optional. default None.</em>) – [-] cosine of solar incidence angle.
has no effect unless law==”minnaert”, in which case it is required.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>limb-darkening value at each input mu value</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float or np.array</p>
</dd>
</dl>
<p class="rubric">References</p>
<p>Overview of published limb darkening laws
<a class="reference external" href="https://www.astro.keele.ac.uk/jkt/codes/jktld.html">https://www.astro.keele.ac.uk/jkt/codes/jktld.html</a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pylanetary.navigation.core.rotate_about_pivot">
<span class="sig-prename descclassname"><span class="pre">pylanetary.navigation.core.</span></span><span class="sig-name descname"><span class="pre">rotate_about_pivot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">angle</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pivot</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pylanetary.navigation.core.rotate_about_pivot" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>img</strong> (<em>np.array</em><em>, </em><em>required</em>) – image to rotate</p></li>
<li><p><strong>angle</strong> (<em>float</em><em>, </em><em>required</em>) – [deg] angle to rotate image (counterclockwise)</p></li>
<li><p><strong>pivot</strong> (<em>tuple</em><em>, </em><em>required</em>) – [px] (x,y) coordinates of pivot point about which to rotate image</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>rotated image</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pylanetary.navigation.core.surface_normal">
<span class="sig-prename descclassname"><span class="pre">pylanetary.navigation.core.</span></span><span class="sig-name descname"><span class="pre">surface_normal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lat_g</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lon_w</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ob_lon</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pylanetary.navigation.core.surface_normal" title="Link to this definition">¶</a></dt>
<dd><p>Computes the normal vector to the surface of the planet.
Take dot product with sub-obs or sub-sun vector to find cosine of emission angle</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lat_g</strong> (<em>np.array</em><em>, </em><em>required</em>) – [deg] planetographic latitude</p></li>
<li><p><strong>lon_w</strong> (<em>np.array</em><em>, </em><em>required</em>) – [deg] west longitude</p></li>
<li><p><strong>ob_lon</strong> (<em>float</em><em>, </em><em>required</em>) – [deg] sub-observer (or sub-sun) planetographic longitude</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>[x,y,z] normal vector to the surface of the planet</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">pylanetary</a></h1>








<h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="description.html">Description</a></li>
<li class="toctree-l1"><a class="reference internal" href="nav-tutorial.html">Navigation tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="nav-examples.html">Example navigation workflow</a></li>
<li class="toctree-l1"><a class="reference internal" href="rings-tutorial.html">Rings Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="utils-tutorial.html">Utils Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributing to Pylanetary</a></li>
<li class="toctree-l1"><a class="reference internal" href="citing.html">Citing this Software</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Navigation API</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#pylanetary.navigation.core.ModelBody"><code class="docutils literal notranslate"><span class="pre">ModelBody</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#pylanetary.navigation.core.ModelEllipsoid"><code class="docutils literal notranslate"><span class="pre">ModelEllipsoid</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#pylanetary.navigation.core.Nav"><code class="docutils literal notranslate"><span class="pre">Nav</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#pylanetary.navigation.core.colocate_diagnostic_plot"><code class="docutils literal notranslate"><span class="pre">colocate_diagnostic_plot()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#pylanetary.navigation.core.emission_angle"><code class="docutils literal notranslate"><span class="pre">emission_angle()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#pylanetary.navigation.core.lat_lon"><code class="docutils literal notranslate"><span class="pre">lat_lon()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#pylanetary.navigation.core.limb_darkening"><code class="docutils literal notranslate"><span class="pre">limb_darkening()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#pylanetary.navigation.core.rotate_about_pivot"><code class="docutils literal notranslate"><span class="pre">rotate_about_pivot()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#pylanetary.navigation.core.surface_normal"><code class="docutils literal notranslate"><span class="pre">surface_normal()</span></code></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="rings_api.html">Rings API</a></li>
<li class="toctree-l1"><a class="reference internal" href="utils_api.html">Utils API</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="citing.html" title="previous chapter">Citing this Software</a></li>
      <li>Next: <a href="rings_api.html" title="next chapter">Rings API</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 7.2.6</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.13</a>
      
      |
      <a href="_sources/navigation_api.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>